<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>알림장 작성</title>
  <link rel="stylesheet" href="/assets/css/note-add.css">
</head>
<body>
<div id="layout-root"></div>

<script>
async function loadLayoutAndContent() {
  // 1. layout.html 불러오기
  const layoutHtml = await fetch('/layout.html').then(r => r.text());
  document.getElementById('layout-root').innerHTML = layoutHtml;

  // 2. 중앙 콘텐츠 주입
  const content = document.getElementById('content');
  if (!content) return;
  content.innerHTML = `
    <div id="noteAddPage">
      <div class="note-card">
        <div class="note-header">
          <h2>알림장 작성</h2>
          <button class="note-btn primary">저장하기</button>
        </div>
        <div class="note-section inline">
          <div>
            <label>날짜</label>
            <input type="date" class="note-input">
          </div>
          <div>
            <label>반 선택</label>
            <select class="note-input">
              <option>반을 선택하세요</option>
            </select>
          </div>
        </div>
        <div class="note-section">
          <label>제목</label>
          <input type="text" class="note-input" placeholder="제목을 입력하세요">
        </div>
        <div class="note-section">
          <label>내용</label>
          <textarea class="note-input" placeholder="내용을 입력하세요"></textarea>
        </div>
        <div class="note-section">
          <label>파일 첨부</label>
          <div class="upload-box">+ 파일 추가</div>
          <p class="tip">이미지: jpg, jpeg, gif, png / 동영상: mp4, mov / 문서: pdf, doc, ppt (15MB 이하)</p>
        </div>
        <div class="note-section">
          <label>활동영역</label>
          <div class="checkbox-group">
            <label><input type="checkbox"> 기본생활</label>
            <label><input type="checkbox"> 신체운동</label>
            <label><input type="checkbox"> 사회관계</label>
            <label><input type="checkbox"> 의사소통</label>
            <label><input type="checkbox"> 예술경험</label>
            <label><input type="checkbox"> 자연탐구</label>
          </div>
        </div>
        <div class="note-section inline">
          <div>
            <label>조식</label>
            <input type="text" class="note-input">
          </div>
          <div>
            <label>중식</label>
            <input type="text" class="note-input">
          </div>
          <div>
            <label>간식</label>
            <input type="text" class="note-input">
          </div>
        </div>
        <div class="note-section">
          <label>생활기록</label>
          <div class="record-options">
            <button class="record-option">좋음</button>
            <button class="record-option">보통</button>
            <button class="record-option">나쁨</button>
          </div>
        </div>
      </div>
    </div>
  `;

  // 3. UI 초기화 실행
  initLayoutUI();
}

// 4. UI 초기화 함수
function initLayoutUI() {
  // 사이드바 토글
  document.querySelectorAll('[data-toggle="sidebar"]').forEach(btn => {
    btn.addEventListener('click', () => {
      document.body.classList.toggle('sidebar-open');
    });
  });

  // 퀵바 토글
  document.querySelectorAll('.ms-quick-bar-item a').forEach(btn => {
    btn.addEventListener('click', e => {
      e.preventDefault();
      const target = btn.getAttribute('href');
      document.querySelectorAll('.ms-quick-bar-item').forEach(item => item.classList.remove('active'));
      btn.parentElement.classList.add('active');
      document.querySelectorAll('.tab-pane').forEach(pane => pane.classList.remove('active'));
      document.querySelector(target)?.classList.add('active');
    });
  });

  // 드롭다운 메뉴
  document.querySelectorAll('[data-toggle="dropdown"]').forEach(drop => {
    drop.addEventListener('click', e => {
      e.preventDefault();
      drop.parentElement.classList.toggle('show');
    });
  });

  console.log('UI 초기화 완료');
}

loadLayoutAndContent();
</script>
</body>
</html>